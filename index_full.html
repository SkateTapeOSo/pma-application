<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>2026 Lifetime PMA-to-PMA Membership Application — Wizard</title>
  <style>
    :root{
      --bg:#0b0c10; --card:#111318; --ink:#e7edf3; --muted:#9fb0bf; --accent:#7cc4ff; --ok:#47d16a; --warn:#ffcc66; --err:#ff6b6b;
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial; color:var(--ink); background:linear-gradient(180deg,#0b0c10,#0d1016 40%,#0b0c10);}
    .wrap{max-width:980px; margin:40px auto; padding:0 16px 64px}
    .card{background:var(--card); border:1px solid #1d2330; border-radius:var(--radius); box-shadow:0 10px 30px rgba(0,0,0,.25)}
    header.hero{padding:28px 24px 18px; border-bottom:1px solid #1d2330}
    header .kicker{letter-spacing:.12em; text-transform:uppercase; color:var(--muted); font-size:12px;}
    header h1{margin:6px 0 6px; font-size:22px}
    header p.sub{margin:0; color:var(--muted)}
    .stepper{display:flex; gap:8px; overflow:auto; padding:14px 16px; border-bottom:1px solid #1d2330}
    .chip{flex:0 0 auto; padding:8px 10px; border-radius:999px; font-size:12px; border:1px solid #2a3446; color:var(--muted)}
    .chip.active{border-color:var(--accent); color:var(--ink); background:rgba(124,196,255,.12)}
    form{padding:18px}
    fieldset{border:none; padding:0; margin:0 0 18px}
    .grid{display:grid; grid-template-columns:1fr; gap:14px}
    @media(min-width:760px){.grid.two{grid-template-columns:1fr 1fr}}
    label{display:block; font-size:13px; color:var(--muted); margin:0 0 6px}
    input,select,textarea{width:100%; padding:11px 12px; border-radius:12px; background:#0f1218; border:1px solid #263043; color:var(--ink); outline:none}
    input:focus,select:focus,textarea:focus{border-color:var(--accent); box-shadow:0 0 0 3px rgba(124,196,255,.15)}
    .hint{font-size:12px; color:var(--muted)}
    .row{display:flex; gap:10px; flex-wrap:wrap}
    .btn{appearance:none; border:none; padding:12px 16px; border-radius:12px; cursor:pointer; font-weight:600}
    .btn.primary{background:linear-gradient(180deg,#88d1ff,#5cb8ff); color:#0a0d12}
    .btn.ghost{background:transparent; color:var(--ink); border:1px solid #2a3446}
    .btn.warn{background:linear-gradient(180deg,#ffe08a,#ffd05b); color:#1a1500}
    .btn.ok{background:linear-gradient(180deg,#7ef1a0,#57d97c); color:#00150a}
    .error{color:var(--err); font-size:12px; margin-top:4px}
    .footer{padding:16px; border-top:1px solid #1d2330; display:flex; gap:8px; flex-wrap:wrap; justify-content:space-between; align-items:center}
    .review{padding:6px 12px; background:#0f141d; border:1px solid #233046; border-radius:12px}
    .kv{display:grid; grid-template-columns:220px 1fr; gap:8px; padding:10px 0; border-bottom:1px solid #1d2330}
    .kv:last-child{border-bottom:none}
    .muted{color:var(--muted)}
    .disclaimer{font-size:12px; color:#b9c7d6; background:#0f141d; border:1px dashed #2a3446; padding:12px; border-radius:12px}
    .badge{display:inline-block; padding:6px 10px; border-radius:999px; background:#0f141d; border:1px solid #2a3446; font-size:12px; color:var(--muted)}
    .thankyou{display:none; text-align:center; font-size:16px; font-weight:600; color:#47d16a; margin:20px 0; opacity:0; transition:opacity 1s ease;}
    .thankyou.show{display:block; opacity:1;}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" id="app">
      <header class="hero">
        <div class="kicker">Bruce Royal Associations</div>
        <h1>2026 Lifetime Membership — PMA‑to‑PMA Application</h1>
        <p class="sub">Walkthrough wizard (like EIN/SSA style). Autosaves to your browser. Print or submit to your endpoint.</p>
      </header>

      <div class="stepper" id="stepper"></div>

      <form id="wizard" novalidate>
        <!-- STEP 1: Applicant PMA -->
        <section data-step="Applicant PMA">
          <fieldset class="grid two">
            <div>
              <label for="pma_name">Full PMA Name</label>
              <input id="pma_name" name="pma_name" required />
              <div class="error" data-err="pma_name"></div>
            </div>
            <div>
              <label for="pma_cert">Registration / Certificate No.</label>
              <input id="pma_cert" name="pma_cert" />
            </div>
            <div>
              <label for="formed_on">Date of Formation</label>
              <input id="formed_on" name="formed_on" type="date" />
            </div>
            <div>
              <label for="jurisdiction">Jurisdiction of Formation</label>
              <input id="jurisdiction" name="jurisdiction" placeholder="State / Territory / Nation" />
            </div>
            <div>
              <label for="address">Mailing Address</label>
              <input id="address" name="address" placeholder="Street, City, State, Postal Code, Country" />
            </div>
            <div>
              <label for="website">Website</label>
              <input id="website" name="website" type="url" placeholder="https://"/>
            </div>
            <div>
              <label for="email">Email</label>
              <input id="email" name="email" type="email" required />
              <div class="error" data-err="email"></div>
            </div>
            <div>
              <label for="phone">Phone</label>
              <input id="phone" name="phone" />
            </div>
          </fieldset>
          <p class="hint">Eligibility: PMA‑to‑PMA only. Apply in your PMA capacity (Founder/Trustee/President).</p>
        </section>

        <!-- STEP 2: Authorized Signatory -->
        <section data-step="Authorized Signatory">
          <fieldset class="grid two">
            <div>
              <label for="signatory_name">Name</label>
              <input id="signatory_name" name="signatory_name" required />
              <div class="error" data-err="signatory_name"></div>
            </div>
            <div>
              <label for="capacity">Title / Capacity</label>
              <input id="capacity" name="capacity" placeholder="Founder / Trustee / President" />
            </div>
            <div>
              <label for="signatory_email">Contact Email</label>
              <input id="signatory_email" name="signatory_email" type="email" />
            </div>
            <div>
              <label for="signatory_phone">Contact Phone</label>
              <input id="signatory_phone" name="signatory_phone" />
            </div>
          </fieldset>
        </section>

        <!-- STEP 3: Documentation -->
        <section data-step="Documentation">
          <fieldset class="grid">
            <label><input type="checkbox" name="doc_cert" /> Certificate of PMA / Affidavit of Publication</label>
            <label><input type="checkbox" name="doc_articles" /> Constitution / Articles of PMA</label>
            <label><input type="checkbox" name="doc_other" /> Other supporting record</label>
            <div class="hint">Attach files when you email or submit; this wizard records which docs you intend to provide.</div>
          </fieldset>
        </section>

        <!-- STEP 4: Declarations & Fees -->
        <section data-step="Declarations">
          <fieldset class="grid">
            <label><input type="checkbox" name="dec_peace" required /> I affirm our PMA is peaceful, faith‑based, and private.</label>
            <label><input type="checkbox" name="dec_pma_only" required /> I understand membership is PMA‑to‑PMA only.</label>
            <label><input type="checkbox" name="dec_entry" required /> I agree to pay the <b>$200 one‑time entry fee</b> (non‑refundable upon approval).</label>
            <label><input type="checkbox" name="dec_monthly" required /> I agree to the <b>$50 monthly service fee</b> beginning January 2026.</label>
          </fieldset>
          <div class="review badge">Pricing: $200 entry (once) + $50/month (from Jan 2026)</div>
        </section>

        <!-- STEP 5: Intent & Alignment -->
        <section data-step="Intent & Alignment">
          <fieldset class="grid">
            <div>
              <label for="intent">Purpose / Intent of Joining</label>
              <textarea id="intent" name="intent" rows="4" placeholder="Tell us why your PMA seeks membership…"></textarea>
            </div>
            <div>
              <label for="align">How your PMA aligns with BRA values</label>
              <textarea id="align" name="align" rows="3"></textarea>
            </div>
            <div class="grid two">
              <div>
                <label for="interview">Request prerequisite interview?</label>
                <select id="interview" name="interview">
                  <option value="No">No</option>
                  <option value="Yes">Yes</option>
                </select>
              </div>
              <div>
                <label for="cohort">Cohort</label>
                <input id="cohort" name="cohort" value="2026" />
              </div>
            </div>
          </fieldset>
        </section>

        <!-- STEP 6: Review & Submit -->
        <section data-step="Review & Submit">
          <div class="review" id="review"></div>
          <div class="disclaimer" style="margin-top:12px">
            <strong>Disclaimer.</strong> PMA‑to‑PMA only. Submission does not guarantee admission. Applications may require an interview. The
            <strong>$200 entry fee is non‑refundable</strong> once approved and invoiced. $50 monthly service fee begins January 2026. Membership operates solely in the private domain under PMA law and ecclesiastical jurisdiction.
          </div>
        </section>

        <div class="footer">
          <div class="row">
            <button class="btn ghost" type="button" id="backBtn">◀ Back</button>
            <button class="btn primary" type="button" id="nextBtn">Next ▶</button>
          </div>
          <div class="row">
            <button class="btn ok" type="button" id="downloadJson">Download JSON</button>
            <button class="btn warn" type="button" id="printBtn">Print / Save as PDF</button>
            <button class="btn primary" type="submit" id="submitBtn" disabled>Submit to Endpoint</button>
          </div>
        </div>
      </form>

      <div id="thankyou" class="thankyou">Thank you for submitting your application!</div>
    </div>

    <p class="hint" style="margin-top:12px">Embed notes: host this file (e.g., GitHub Pages) and place it in a Square Online “Embed Code” block with an <code>&lt;iframe&gt;</code>. Configure your submission endpoint in the script below.</p>
  </div>

  <script>
    // ---- Simple multi-step controller ----
    const form = document.getElementById('wizard');
    const sections = [...form.querySelectorAll('section')];
    const stepper = document.getElementById('stepper');
    const backBtn = document.getElementById('backBtn');
    const nextBtn = document.getElementById('nextBtn');
    const submitBtn = document.getElementById('submitBtn');
    const printBtn = document.getElementById('printBtn');
    const downloadJsonBtn = document.getElementById('downloadJson');
    const reviewEl = document.getElementById('review');

    let idx = 0;

    // Build stepper chips
    const chips = sections.map((s,i)=>{
      const el = document.createElement('div');
      el.className = 'chip';
      el.textContent = `${i+1}. ${s.dataset.step}`;
      stepper.appendChild(el);
      return el;
    });

    function setStep(n){
      idx = Math.max(0, Math.min(sections.length-1, n));
      sections.forEach((s,i)=>{ s.style.display = i===idx? 'block':'none'; });
      chips.forEach((c,i)=>{ c.classList.toggle('active', i===idx); });
      backBtn.disabled = idx===0;
      nextBtn.style.display = idx===sections.length-1 ? 'none':'inline-block';
      submitBtn.style.display = idx===sections.length-1 ? 'inline-block':'none';
      // On final step, refresh review and enable submit if valid
      if(idx===sections.length-1){
        renderReview();
        submitBtn.disabled = !form.checkValidity();
      }
      save();
    }

    // Autosave / restore
    const KEY = 'bra_pma_app_2026';
    function save(){
      const data = Object.fromEntries(new FormData(form).entries());
      localStorage.setItem(KEY, JSON.stringify(data));
    }
    function restore(){
      try{
        const data = JSON.parse(localStorage.getItem(KEY)||'{}');
        for(const [k,v] of Object.entries(data)){
          const el = form.elements[k];
          if(!el) continue;
          if(el.type==='checkbox') el.checked = v === 'on' || v === true;
          else el.value = v;
        }
      }catch(e){}
    }

    // Validation helpers
    function showErrors(){
      const req = [...form.querySelectorAll('[required]')];
      req.forEach(el=>{
        const box = form.querySelector(`[data-err=\"${el.name}\"]`);
        if(!box) return;
        box.textContent = el.validity.valid? '' : 'This field is required.';
      });
    }

    function renderReview(){
      const data = Object.fromEntries(new FormData(form).entries());
      const entries = [
        ['PMA Name', data.pma_name],
        ['Registration / Cert No.', data.pma_cert],
        ['Formation Date', data.formed_on],
        ['Jurisdiction', data.jurisdiction],
        ['Mailing Address', data.address],
        ['Email', data.email],
        ['Phone', data.phone],
        ['Website', data.website],
        ['Signatory Name', data.signatory_name],
        ['Capacity', data.capacity],
        ['Interview Requested', data.interview||'No'],
        ['Intent', (data.intent||'').slice(0,400)],
        ['Alignment', (data.align||'').slice(0,400)],
        ['Docs: Cert/Publ.', form.elements.doc_cert.checked? 'Yes':'No'],
        ['Docs: Constitution/Articles', form.elements.doc_articles.checked? 'Yes':'No'],
        ['Docs: Other', form.elements.doc_other.checked? 'Yes':'No'],
        ['Declarations', ['dec_peace','dec_pma_only','dec_entry','dec_monthly'].map(k=>form.elements[k].checked? '✔':'✘').join(' ')]
      ];
      reviewEl.innerHTML = entries.map(([k,v])=>`<div class="kv"><div class="muted">${k}</div><div>${v||'<span class=muted>—</span>'}</div></div>`).join('');
    }

    backBtn.addEventListener('click', ()=>{ setStep(idx-1); });
    nextBtn.addEventListener('click', ()=>{
      showErrors();
      if(idx<sections.length-1){ setStep(idx+1); }
    });

    form.addEventListener('input', ()=>{ save(); showErrors(); if(idx===sections.length-1) submitBtn.disabled = !form.checkValidity(); });

    downloadJsonBtn.addEventListener('click', ()=>{
      const data = Object.fromEntries(new FormData(form).entries());
      const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = `BRA_PMA_Application_${(data.pma_name||'').replace(/\W+/g,'_')||'2026'}.json`;
      a.click();
    });

    printBtn.addEventListener('click', ()=>{
      renderReview();
      window.print(); // Users can Save as PDF
    });

    // Configure your endpoint here (Formspree)
    const SUBMIT_URL = 'https://formspree.io/f/xpwjbrpy'; // real endpoint

    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      showErrors();
      if(!form.checkValidity()) return;
      const data = Object.fromEntries(new FormData(form).entries());
      try{
        submitBtn.disabled = true; submitBtn.textContent = 'Submitting…';
        const res = await fetch(SUBMIT_URL, {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify(data)
        });
        if(!res.ok) throw new Error('HTTP '+res.status);
        // Fade in thank you
        const ty = document.getElementById('thankyou');
        ty.classList.add('show');
        setTimeout(()=>{ ty.classList.remove('show'); }, 6000); // fade out after 6s
      }catch(err){
        alert('Submission failed. Please email your saved PDF/JSON to support@bruceroyaltrust.services');
      }finally{
        submitBtn.disabled = false; submitBtn.textContent = 'Submit to Endpoint';
      }
    });

    // Init
    restore();
    setStep(0);
  </script>
</body>
</html>
